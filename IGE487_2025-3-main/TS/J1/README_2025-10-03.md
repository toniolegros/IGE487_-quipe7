# Corrections des inadéquations dans les fichiers SQL

## Date : 2025-10-03

### 1. Problèmes dans la structure des tables

#### Correction : Table `Taux`
- **Problème** : Les catégories (`tCat`) ne forment pas une partition stricte de l'intervalle [0..100]. Il y a des chevauchements et des valeurs hors limites.
- **Solution** : Ajout de contraintes pour garantir que les catégories forment une partition stricte et que les valeurs sont dans l'intervalle [0..100].
- **Impact** : Amélioration de la cohérence des données et des requêtes basées sur cette table.

#### Correction : Table `Placette`
- **Problème** : Les références vers `Taux` (`obs_F1`, `obs_F2`, etc.) ne sont pas validées par des contraintes explicites.
- **Solution** : Ajout de contraintes de clé étrangère pour valider les références.
- **Impact** : Garantie de l'intégrité référentielle entre les tables.

### 2. Problèmes dans les données

#### Correction : Jeu de données (`Herbivorie_jeu2.sql`, `Herbivorie_jeu3.sql`)
- **Problème** : Les données incluent des cas limites et des chevauchements dans `Taux`.
- **Solution** : Nettoyage des données pour supprimer les chevauchements et les valeurs hors normes.
- **Impact** : Amélioration de la qualité des données pour les tests.

### 3. Problèmes dans les requêtes

#### Correction : Requêtes (`Herbivorie_req2.sql`)
- **Problème** : Les noms d'attributs similaires entre les tables rendent les requêtes complexes.
- **Solution** : Refactorisation des noms d'attributs pour éviter les ambiguïtés.
- **Impact** : Simplification des requêtes et réduction des erreurs potentielles.

### 4. Problèmes de performance

#### Correction : Index manquants
- **Problème** : Les colonnes fréquemment utilisées dans les requêtes ne sont pas indexées.
- **Solution** : Ajout d'index sur les colonnes clés comme `id` dans `ObsDimension`.
- **Impact** : Amélioration des performances des requêtes.

### 5. Problèmes de cohérence

#### Correction : Données de terrain
- **Problème** : Les jeux de données existants ne permettent pas de tester toutes les requêtes.
- **Solution** : Ajout de jeux de données complémentaires pour couvrir les cas limites.
- **Impact** : Meilleure couverture des tests et validation des requêtes.

---

# Documentation des inadéquations et corrections

## Inadéquations identifiées

### Y1 : Tables météo
- **Problème** : Les tables météo ne géraient pas correctement les données manquantes.
- **Correction** : Ajout de contraintes pour valider les données et gestion explicite des valeurs nulles.
- **Statut** : Corrigé.

### Y2 : CarnetMeteo
- **Problème** : La procédure d’alimentation permettait des incohérences dans les données.
- **Correction** : Mise à jour de la procédure pour inclure des validations strictes.
- **Statut** : Corrigé.

### Y3 : Vue pour conditions météo
- **Problème** : La vue excluait les précipitations mais ne gérait pas les données manquantes.
- **Correction** : Ajout de filtres pour gérer les données manquantes.
- **Statut** : Corrigé.

### Y4 : Suppression des données
- **Problème** : Les données avec Tmin < seuil n’étaient pas supprimées correctement.
- **Correction** : Création d’une procédure pour supprimer ces données.
- **Statut** : Corrigé.

### Y5 : Augmentation des températures
- **Problème** : Absence de procédure pour augmenter les températures d’un pourcentage donné.
- **Correction** : Ajout de la procédure `AugmenterTemperatures`.
- **Statut** : Corrigé.

### Y6 : Intervalles dans `Taux`
- **Problème** : Les intervalles dans `Taux` se chevauchaient.
- **Correction** : Ajout d’un trigger pour garantir la compacité des intervalles.
- **Statut** : Corrigé.

### Y7 : Table `ObsFloraison`
- **Problème** : La colonne `fleur` était redondante et les données incohérentes.
- **Correction** : Suppression de la colonne et nettoyage des données.
- **Statut** : Corrigé.

### Y8 : Renommage de `peup`
- **Problème** : Le nom de la table `peup` était ambigu.
- **Correction** : Renommage en `peuplement` et mise à jour des dépendances.
- **Statut** : Corrigé.

### Anomalies supplémentaires

#### Structure des tables
- **Problème** : Les catégories dans `Taux` ne formaient pas une partition stricte.
- **Correction** : Ajout de contraintes pour garantir une partition stricte.
- **Statut** : Corrigé.

#### Données hors normes
- **Problème** : Données hors normes dans certains jeux de données.
- **Correction** : Nettoyage des données et ajout de validations.
- **Statut** : Corrigé.

#### Index manquants
- **Problème** : Absence d’index sur des colonnes fréquemment utilisées.
- **Correction** : Ajout d’index sur les colonnes clés.
- **Statut** : Corrigé.

#### Jeux de données insuffisants
- **Problème** : Les jeux de données ne couvraient pas tous les cas limites.
- **Correction** : Ajout de jeux de données complémentaires.
- **Statut** : Corrigé.

---

# Plan complet de normalisation

## Objectif
Le plan de normalisation vise à garantir que les bases de données respectent les principes de normalisation, minimisent les redondances, et assurent l'intégrité des données. Ce plan détaille les étapes suivies pour résoudre les inadéquations identifiées et les choix effectués pour normaliser les structures.

## Étapes de normalisation

### 1. Analyse des structures existantes
- **Action** : Identifier les dépendances fonctionnelles, les clés primaires, et les relations entre les tables.
- **Résultat** : Les dépendances ont été clarifiées, et les relations entre les tables ont été documentées.

### 2. Résolution des inadéquations
- **Y1 : Tables météo**
  - Ajout de contraintes pour valider les données et gérer les valeurs nulles.
- **Y2 : CarnetMeteo**
  - Mise à jour de la procédure d’alimentation pour inclure des validations strictes.
- **Y3 : Vue pour conditions météo**
  - Ajout de filtres pour gérer les données manquantes.
- **Y4 : Suppression des données**
  - Création d’une procédure pour supprimer les données avec Tmin < seuil.
- **Y5 : Augmentation des températures**
  - Ajout de la procédure `AugmenterTemperatures`.
- **Y6 : Intervalles dans `Taux`**
  - Ajout d’un trigger pour garantir la compacité des intervalles.
- **Y7 : Table `ObsFloraison`**
  - Suppression de la colonne `fleur` et nettoyage des données.
- **Y8 : Renommage de `peup`**
  - Renommage en `peuplement` et mise à jour des dépendances.

### 3. Ajout de contraintes et triggers
- **Action** : Ajouter des contraintes de clé étrangère, des triggers pour valider les données, et des index pour améliorer les performances.
- **Résultat** : Les bases de données sont conformes aux principes de normalisation.

### 4. Nettoyage des données
- **Action** : Supprimer les données redondantes, corriger les incohérences, et compléter les jeux de données pour couvrir les cas limites.
- **Résultat** : Les données sont cohérentes et prêtes pour les tests.

### 5. Documentation
- **Action** : Documenter toutes les corrections et les choix de conception dans le fichier README.
- **Résultat** : Une documentation complète est disponible pour référence future.

## Résultats attendus
- Bases de données normalisées et conformes aux principes de la 3NF.
- Données cohérentes et prêtes pour les analyses.
- Documentation complète pour faciliter la maintenance et les évolutions futures.

---

### Résumé des corrections
Les corrections apportées visent à améliorer la structure des tables, la qualité des données, la clarté des requêtes, les performances, et la cohérence globale du modèle. Ces modifications garantissent une meilleure interopérabilité et facilitent les tests et l'utilisation des données dans le projet Herbivorie.